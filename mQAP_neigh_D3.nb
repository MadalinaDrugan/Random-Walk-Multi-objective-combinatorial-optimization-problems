(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    829321,      19921]
NotebookOptionsPosition[    821762,      19835]
NotebookOutlinePosition[    822108,      19850]
CellTagsIndexPosition[    822065,      19847]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"L", " ", "=", "20"}], "\[IndentingNewLine]", 
 RowBox[{"D1", " ", "=", " ", "3"}], "\[IndentingNewLine]", 
 RowBox[{"N1", " ", "=", " ", 
  RowBox[{"L", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"L", "-", "1"}], ")"}], "/", "2"}]}]}]}], "Input",
 CellChangeTimes->{{3.7685434499479303`*^9, 3.7685434732997847`*^9}, {
   3.7687568562796392`*^9, 3.768756864488737*^9}, 3.7687596973020844`*^9, 
   3.7687600416116424`*^9, 3.768924393350584*^9, {3.76926679773215*^9, 
   3.7692667982249165`*^9}, {3.7693323518457265`*^9, 
   3.7693323552271147`*^9}, {3.769402265158084*^9, 3.769402265447946*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"0bd87496-db0f-4ec9-8596-2c2cd79e7339"],

Cell[BoxData[{
 RowBox[{"sD", " ", "=", " ", 
  "\"\<DistanceM_cQAP_KC_20.txt\>\""}], "\[IndentingNewLine]", 
 RowBox[{"sM1", " ", "=", " ", 
  "\"\<FlowM1_cQAP_KC_20.txt\>\""}], "\[IndentingNewLine]", 
 RowBox[{"sM2", " ", "=", " ", 
  "\"\<FlowM2_cQAP_KC_20.txt\>\""}], "\[IndentingNewLine]", 
 RowBox[{"sM3", " ", "=", " ", 
  "\"\<H:\\\\Madalina\\\\MyMathematica\\\\RW_mQAP_mNK\\\\mQAP\\\\numeric_mQAP\
\\\\FlowM3_cQAP_KC_20.txt\>\""}]}], "Input",
 CellChangeTimes->{{3.7685435262075033`*^9, 3.7685436362679396`*^9}, {
   3.7685436680597577`*^9, 3.768543697690606*^9}, {3.7685440698708553`*^9, 
   3.768544086737807*^9}, {3.7685441428320284`*^9, 3.768544221569413*^9}, 
   3.7685446648137074`*^9, 3.76854492205285*^9, {3.7685450415727696`*^9, 
   3.768545044981151*^9}, {3.7687597088855567`*^9, 3.768759784020669*^9}, {
   3.768924315688685*^9, 3.7689243161064816`*^9}, {3.7689243473155713`*^9, 
   3.7689243878742027`*^9}, {3.7689244370597057`*^9, 
   3.7689244706096973`*^9}, {3.7692668185651894`*^9, 3.769266865800661*^9}, {
   3.769332286518919*^9, 3.7693322980074186`*^9}, {3.7693325793310747`*^9, 
   3.769332637275409*^9}, {3.7693496402553787`*^9, 3.769349655072307*^9}, {
   3.7693525532898984`*^9, 3.769352574138935*^9}, {3.7693563838334527`*^9, 
   3.769356388569198*^9}, {3.769402377403516*^9, 3.7694024057839737`*^9}, {
   3.8170354379978743`*^9, 
   3.8170354612787623`*^9}},ExpressionUUID->"f34464f0-40d0-471f-8985-\
a3d280e1cb83"],

Cell[BoxData[{
 RowBox[{"fileD", "=", " ", 
  RowBox[{"OpenRead", "[", "sD", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
   RowBox[{"i", " ", "\[LessEqual]", " ", "L"}], ",", " ", 
   RowBox[{"i", "++"}], ",", " ", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", " ", 
     RowBox[{"j", " ", "\[LessEqual]", " ", "L"}], ",", " ", 
     RowBox[{"j", "++"}], ",", 
     RowBox[{
      RowBox[{"temp1", " ", "=", " ", 
       RowBox[{"Read", "[", 
        RowBox[{"fileD", ",", "Real"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"distance", "[", 
        RowBox[{"i", ",", "j"}], "]"}], " ", "=", " ", "temp1"}]}]}], "]"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"Close", "[", "fileD", "]"}], "\[IndentingNewLine]", 
 RowBox[{"distance", "[", 
  RowBox[{"1", ",", "2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"distance", "[", 
  RowBox[{"1", ",", "3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"distance", "[", 
  RowBox[{"2", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"distance", "[", 
  RowBox[{"3", ",", "4"}], "]"}]}], "Input",
 CellChangeTimes->{{3.768543753824797*^9, 3.7685438303072715`*^9}, {
   3.7685439935623026`*^9, 3.768543999714367*^9}, {3.768544602749362*^9, 
   3.7685446706619244`*^9}, {3.7685447574064865`*^9, 3.7685447747692027`*^9}, 
   3.768788659949975*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"60273512-7864-403c-be58-f9c76b786042"],

Cell[BoxData[{
 RowBox[{"fileM1", " ", "=", " ", 
  RowBox[{"OpenRead", "[", "sM1", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
   RowBox[{"i", " ", "\[LessEqual]", " ", "L"}], ",", " ", 
   RowBox[{"i", "++"}], ",", " ", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", " ", 
     RowBox[{"j", " ", "\[LessEqual]", " ", "L"}], ",", " ", 
     RowBox[{"j", "++"}], ",", 
     RowBox[{
      RowBox[{"temp1", " ", "=", " ", 
       RowBox[{"Read", "[", 
        RowBox[{"fileM1", ",", "Real"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"flowM1", "[", 
        RowBox[{"i", ",", "j"}], "]"}], " ", "=", " ", "temp1"}]}]}], "]"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"Close", "[", "fileM1", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"flowM1", "[", 
   RowBox[{"1", ",", "3"}], "]"}], " ", "*", " ", 
  "2"}], "\[IndentingNewLine]", 
 RowBox[{"flowM1", "[", 
  RowBox[{"4", ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7685439663203034`*^9, 3.7685440340099883`*^9}, {
   3.7685448217507687`*^9, 3.7685448236248703`*^9}, {3.768544927516258*^9, 
   3.7685449823680573`*^9}, {3.7687884937353673`*^9, 
   3.7687885091530013`*^9}, {3.768788565628022*^9, 3.7687885814154987`*^9}, 
   3.768788612207785*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"bb35a381-c285-4e0a-82d9-8f36c7801f43"],

Cell[BoxData[{
 RowBox[{"fileM2", " ", "=", " ", 
  RowBox[{"OpenRead", "[", "sM2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
   RowBox[{"i", " ", "\[LessEqual]", " ", "L"}], ",", " ", 
   RowBox[{"i", "++"}], ",", " ", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", " ", 
     RowBox[{"j", " ", "\[LessEqual]", " ", "L"}], ",", " ", 
     RowBox[{"j", "++"}], ",", 
     RowBox[{
      RowBox[{"temp1", " ", "=", " ", 
       RowBox[{"Read", "[", 
        RowBox[{"fileM2", ",", "Real"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"flowM2", "[", 
        RowBox[{"i", ",", "j"}], "]"}], " ", "=", " ", "temp1"}]}]}], "]"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"Close", "[", "fileM2", "]"}]}], "Input",
 CellChangeTimes->{
  3.7685440556076612`*^9, {3.7685442463055964`*^9, 3.768544249744948*^9}, {
   3.768545053242199*^9, 3.768545081369768*^9}, 3.768788622284972*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"0bca0c09-008e-4e05-a6f1-6a540435af18"],

Cell[BoxData[{
 RowBox[{"fileM3", " ", "=", " ", 
  RowBox[{"OpenRead", "[", "sM3", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
   RowBox[{"i", " ", "\[LessEqual]", " ", "L"}], ",", " ", 
   RowBox[{"i", "++"}], ",", " ", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", " ", 
     RowBox[{"j", " ", "\[LessEqual]", " ", "L"}], ",", " ", 
     RowBox[{"j", "++"}], ",", 
     RowBox[{
      RowBox[{"temp1", " ", "=", " ", 
       RowBox[{"Read", "[", 
        RowBox[{"fileM3", ",", "Real"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"flowM3", "[", 
        RowBox[{"i", ",", "j"}], "]"}], " ", "=", " ", "temp1"}]}]}], "]"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"Close", "[", "fileM3", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.76854429707635*^9, 3.76854440433811*^9}, {
   3.768544487277504*^9, 3.7685444889667053`*^9}, 3.768544600686333*^9, 
   3.7685449479734716`*^9, {3.7685450667067885`*^9, 3.76854508764577*^9}, {
   3.768759804864714*^9, 3.7687598116544685`*^9}, {3.7689244923743014`*^9, 
   3.7689244947541547`*^9}, {3.768975995495298*^9, 3.7689760024159975`*^9}, {
   3.769332651586549*^9, 3.769332676859497*^9}, 3.7693461044080715`*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"8f29069e-1b7c-4f7d-9a44-9ddc6d4aff64"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Compute", " ", "the", " ", "contribution", " ", "of", " ", "each", " ", 
    "two", " ", "bits"}], "*)"}], "\[IndentingNewLine]", "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"i", ",", 
    RowBox[{
     RowBox[{"j", " ", "--"}], ">"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"countI", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", " ", "L"}], ",", " ", 
     RowBox[{"i", "++"}], ",", " ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"j", " ", "\[LessEqual]", " ", "L"}], ",", " ", 
       RowBox[{"j", "++"}], ",", " ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", " ", 
         RowBox[{"k", " ", "\[LessEqual]", " ", "L"}], ",", " ", 
         RowBox[{"k", "++"}], ",", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"i", " ", "\[NotEqual]", " ", "j"}], " ", "&&", " ", 
            RowBox[{"i", " ", "\[NotEqual]", " ", "k"}], " ", "&&", " ", 
            RowBox[{"j", " ", "\[NotEqual]", " ", "k"}]}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"pIndex", "[", 
              RowBox[{"countI", ",", "1"}], "]"}], " ", "=", " ", "i"}], ";", 
            RowBox[{
             RowBox[{"pIndex", "[", 
              RowBox[{"countI", ",", "2"}], "]"}], "=", " ", "j"}], ";", " ", 
            RowBox[{
             RowBox[{"pIndex", "[", 
              RowBox[{"countI", ",", "3"}], "]"}], " ", "=", " ", "k"}], ";", 
            " ", 
            RowBox[{"countI", " ", "=", " ", 
             RowBox[{"countI", " ", "+", " ", "1"}]}]}], ","}], "]"}]}], 
        "]"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", "countI", 
   "\[IndentingNewLine]", 
   RowBox[{"pIndex", "[", 
    RowBox[{"2", ",", "1"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"pIndex", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"pIndex", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7685451382496004`*^9, 3.768545153588281*^9}, 
   3.7685451930274644`*^9, {3.7685476811286187`*^9, 3.7685476816623545`*^9}, {
   3.768713339673622*^9, 3.7687133512271023`*^9}, {3.7687135117654343`*^9, 
   3.768713522052523*^9}, {3.768713555205688*^9, 3.768713560380213*^9}, 
   3.76875764829138*^9, {3.768757700685362*^9, 3.7687577103807373`*^9}, {
   3.768758092948312*^9, 3.7687582508349085`*^9}, {3.7687582849156303`*^9, 
   3.768758385085785*^9}, {3.7687603343068523`*^9, 3.7687603540904074`*^9}, {
   3.7687603955296125`*^9, 3.7687604143296385`*^9}, {3.768760469471303*^9, 
   3.7687605035540247`*^9}, {3.768760546927313*^9, 3.7687605557061176`*^9}, {
   3.768760631970693*^9, 3.768760668273357*^9}, {3.7687607005679407`*^9, 
   3.7687607015614586`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"46743b3d-1e13-4156-8fe6-d6d1da96c3ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"**", "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
          "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
   "*******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "exact", " ", "mean"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FM1", " ", "=", " ", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"flowM1", "[", 
        RowBox[{"j", ",", "k"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"FM2", " ", "=", " ", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"flowM2", "[", 
        RowBox[{"j", ",", "k"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"FM3", " ", "=", " ", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"flowM3", "[", 
        RowBox[{"j", ",", "k"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"FM4", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"flowM4", "[", 
           RowBox[{"j", ",", "k"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"L", "*", "L"}], ")"}]}], "\[IndentingNewLine]", "FM5"}], 
      " ", "=", " ", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"flowM5", "[", 
          RowBox[{"j", ",", "k"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"L", "*", "L"}], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Dij", " ", "=", " ", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"distance", "[", 
        RowBox[{"j", ",", "k"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
     RowBox[{"i", "\[LessEqual]", " ", "L"}], ",", " ", 
     RowBox[{"i", "++"}], ",", " ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "L"}], ",", " ", 
       RowBox[{"j", "++"}], ",", " ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", " ", 
         RowBox[{"k", "\[LessEqual]", " ", "L"}], ",", " ", 
         RowBox[{"k", "++"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"EG1ij", "[", 
            RowBox[{"i", ",", "j", ",", " ", "k"}], "]"}], " ", "=", " ", 
           RowBox[{"FM1", " ", "*", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"distance", "[", 
               RowBox[{"i", ",", "k"}], "]"}], "+", 
              RowBox[{"distance", "[", 
               RowBox[{"j", ",", "k"}], "]"}]}], ")"}]}]}], ";", 
          RowBox[{
           RowBox[{"EG2ij", "[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], " ", "=", " ", 
           RowBox[{"FM2", " ", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"distance", "[", 
               RowBox[{"i", ",", "k"}], "]"}], "+", 
              RowBox[{"distance", "[", 
               RowBox[{"j", ",", "k"}], "]"}]}], ")"}]}]}], ";", 
          RowBox[{
           RowBox[{"EG3ij", "[", 
            RowBox[{"i", ",", "j", ",", " ", "k"}], "]"}], "=", " ", 
           RowBox[{"FM3", " ", "*", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"distance", "[", 
               RowBox[{"i", ",", "k"}], "]"}], "+", 
              RowBox[{"distance", "[", 
               RowBox[{"j", ",", "k"}], "]"}]}], ")"}]}]}]}]}], "]"}]}], 
      "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"EEG1ij", " ", "=", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"EG1ij", "[", 
       RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"EEG2ij", " ", "=", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"EG2ij", "[", 
       RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"EEG3ij", " ", "=", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"EG3ij", "[", 
       RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"EG4ij", "[", 
       RowBox[{"i", ",", "j", ",", "k"}], "]"}], " ", "=", " ", 
      RowBox[{"FM4", " ", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"distance", "[", 
          RowBox[{"i", ",", "k"}], "]"}], "+", 
         RowBox[{"distance", "[", 
          RowBox[{"j", ",", "k"}], "]"}]}], ")"}]}]}], ";", 
     RowBox[{
      RowBox[{"EG5ij", "[", 
       RowBox[{"i", ",", "j", ",", "k"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"FM5", " ", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"distance", "[", 
           RowBox[{"i", ",", "k"}], "]"}], "+", 
          RowBox[{"distance", "[", 
           RowBox[{"j", ",", "k"}], "]"}]}], ")"}], "EEG4ij"}], " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"EG4ij", "[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "EEG5ij"}], " ", "=", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"EG5ij", "[", 
           RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}]}]}]}]}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{
  3.7687625233004074`*^9, {3.7687625900325356`*^9, 3.7687626319924965`*^9}, {
   3.768762733240141*^9, 3.76876286680735*^9}, {3.7687873955409093`*^9, 
   3.768787399659943*^9}, {3.7687877796514893`*^9, 3.7687878113703384`*^9}, {
   3.768787895362224*^9, 3.7687882692336664`*^9}, {3.7688167747103453`*^9, 
   3.768816916888452*^9}, 3.768827250709633*^9, {3.7689245802903028`*^9, 
   3.768924592570449*^9}, {3.768924622895953*^9, 3.7689246307492127`*^9}, {
   3.768924679435953*^9, 3.768924797396614*^9}, {3.7693327993060064`*^9, 
   3.7693328302432284`*^9}, {3.769332862863658*^9, 3.7693328689637384`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"9026733f-7e3f-446b-86b8-b5670f2c6b96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"**", "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
         "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "******)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"compute", " ", "variance", " ", "between", " ", "objectives"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"VM1ij", " ", "=", " ", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"flowM1", "[", 
           RowBox[{"i", ",", "j"}], "]"}], " ", "-", " ", "FM1"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"flowM1", "[", 
           RowBox[{"i", ",", "j"}], "]"}], " ", "-", " ", "FM1"}], ")"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "L"}], "}"}]}], "]"}], " ", "/", " ", 
     RowBox[{"(", 
      RowBox[{"L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"VM2ij", " ", "=", " ", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"flowM2", "[", 
           RowBox[{"i", ",", "j"}], "]"}], " ", "-", " ", "FM2"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"flowM2", "[", 
           RowBox[{"i", ",", "j"}], "]"}], " ", "-", " ", "FM2"}], ")"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "L"}], "}"}]}], "]"}], " ", "/", " ", 
     RowBox[{"(", 
      RowBox[{"L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"VM3ij", " ", "=", " ", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"flowM3", "[", 
           RowBox[{"i", ",", "j"}], "]"}], " ", "-", " ", "FM3"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"flowM3", "[", 
           RowBox[{"i", ",", "j"}], "]"}], " ", "-", " ", "FM3"}], ")"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "L"}], "}"}]}], "]"}], " ", "/", " ", 
     RowBox[{"(", 
      RowBox[{"L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"VM4ij", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"flowM4", "[", 
              RowBox[{"i", ",", "j"}], "]"}], " ", "-", " ", "FM4"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"flowM4", "[", 
              RowBox[{"i", ",", "j"}], "]"}], " ", "-", " ", "FM4"}], ")"}]}],
           ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "L"}], "}"}]}], "]"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{"L", "*", "L"}], ")"}]}], "\[IndentingNewLine]", "VM5ij"}], 
      " ", "=", " ", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"flowM5", "[", 
             RowBox[{"i", ",", "j"}], "]"}], " ", "-", " ", "FM5"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"flowM5", "[", 
             RowBox[{"i", ",", "j"}], "]"}], " ", "-", " ", "FM5"}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "L"}], "}"}]}], "]"}], " ", "/", " ", 
       RowBox[{"(", 
        RowBox[{"L", "*", "L"}], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"VDij", " ", "=", " ", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"distance", "[", 
           RowBox[{"i", ",", "j"}], "]"}], " ", "-", " ", "Dij"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"distance", "[", 
           RowBox[{"i", ",", "j"}], "]"}], " ", "-", " ", "Dij"}], ")"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "L"}], "}"}]}], "]"}], " ", "/", " ", 
     RowBox[{"(", 
      RowBox[{"L", "*", "L"}], ")"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.768815728314093*^9, 3.7688158377698174`*^9}, {
   3.7688158908634644`*^9, 3.768815894512721*^9}, {3.768815946706793*^9, 
   3.768816095436762*^9}, {3.7688161510092196`*^9, 3.768816167698246*^9}, {
   3.7688164010558004`*^9, 3.768816488430069*^9}, {3.768816599140206*^9, 
   3.7688166360105886`*^9}, {3.768816960082824*^9, 3.7688169999847574`*^9}, {
   3.7688172034775667`*^9, 3.7688173714263678`*^9}, {3.7688254646576405`*^9, 
   3.7688255134893184`*^9}, 3.768825572289236*^9, {3.768825754817062*^9, 
   3.7688257943052*^9}, {3.7688258313255253`*^9, 3.7688258511270666`*^9}, {
   3.7688259281712723`*^9, 3.7688259415608883`*^9}, 3.7688260134085636`*^9, {
   3.768826615603957*^9, 3.768826677452417*^9}, 3.768826737549719*^9, {
   3.768826890464684*^9, 3.7688270427339735`*^9}, {3.768827087170743*^9, 
   3.7688271254514627`*^9}, {3.7688271687617693`*^9, 
   3.7688272068155985`*^9}, {3.768827237647871*^9, 3.7688272452002635`*^9}, {
   3.768924888018335*^9, 3.768924930343129*^9}, {3.768927795257848*^9, 
   3.7689278484034686`*^9}, {3.7693329046067305`*^9, 3.7693329092754965`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"0d5a285f-0f3b-44be-aa0c-1e26eb4063dc"],

Cell[BoxData[{
 RowBox[{"EM12ij", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"flowM1", "[", 
       RowBox[{"i1", ",", "j1"}], "]"}], " ", 
      RowBox[{"flowM2", "[", 
       RowBox[{"i1", ",", "j1"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i1", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j1", ",", "1", ",", "L"}], "}"}]}], "]"}], " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EM13ij", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"flowM1", "[", 
        RowBox[{"i1", ",", "j1"}], "]"}], " ", 
       RowBox[{"flowM3", "[", 
        RowBox[{"i1", ",", "j1"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i1", ",", "1", ",", "L"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j1", ",", "1", ",", "L"}], "}"}]}], "]"}], " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"EM14ij", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"flowM1", "[", 
           RowBox[{"i1", ",", "j1"}], "]"}], " ", 
          RowBox[{"flowM4", "[", 
           RowBox[{"i1", ",", "j1"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", "1", ",", "L"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", "1", ",", "L"}], "}"}]}], "]"}], " ", "/", " ", 
       RowBox[{"(", 
        RowBox[{"L", "*", "L"}], ")"}]}], "\[IndentingNewLine]", "EM15ij"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"flowM1", "[", 
          RowBox[{"i1", ",", "j1"}], "]"}], " ", 
         RowBox[{"flowM5", "[", 
          RowBox[{"i1", ",", "j1"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j1", ",", "1", ",", "L"}], "}"}]}], "]"}], " ", "/", " ", 
      RowBox[{"(", 
       RowBox[{"L", "*", "L"}], ")"}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"EM23ij", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"flowM2", "[", 
       RowBox[{"i1", ",", "j1"}], "]"}], " ", 
      RowBox[{"flowM3", "[", 
       RowBox[{"i1", ",", "j1"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i1", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j1", ",", "1", ",", "L"}], "}"}]}], "]"}], " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"EM1ij", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"flowM1", "[", 
       RowBox[{"i1", ",", "j1"}], "]"}], " ", 
      RowBox[{"flowM1", "[", 
       RowBox[{"i1", ",", "j1"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i1", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j1", ",", "1", ",", "L"}], "}"}]}], "]"}], " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"EM2ij", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"flowM2", "[", 
       RowBox[{"i1", ",", "j1"}], "]"}], " ", 
      RowBox[{"flowM2", "[", 
       RowBox[{"i1", ",", "j1"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i1", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j1", ",", "1", ",", "L"}], "}"}]}], "]"}], " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"EM3ij", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"flowM3", "[", 
       RowBox[{"i1", ",", "j1"}], "]"}], " ", 
      RowBox[{"flowM3", "[", 
       RowBox[{"i1", ",", "j1"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i1", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j1", ",", "1", ",", "L"}], "}"}]}], "]"}], " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
   RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
   RowBox[{"i1", "++"}], ",", " ", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j1", " ", "=", " ", "1"}], ",", 
     RowBox[{"j1", " ", "\[LessEqual]", " ", "L"}], ",", " ", 
     RowBox[{"j1", "++"}], ",", " ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", " ", 
       RowBox[{"k1", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"DM12ij", "[", 
          RowBox[{"i1", ",", "j1", ",", "k1"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"EM12ij", " ", "-", 
            RowBox[{"FM1", " ", "*", " ", "FM2"}]}], ")"}], "*", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"distance", "[", 
              RowBox[{"i1", ",", "k1"}], "]"}], "+", 
             RowBox[{"distance", "[", 
              RowBox[{"j1", ",", "k1"}], "]"}]}], ")"}], "^", "2"}]}]}], " ", 
        ";", 
        RowBox[{
         RowBox[{"DM13ij", "[", 
          RowBox[{"i1", ",", "j1", ",", "k1"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"EM13ij", " ", "-", 
            RowBox[{"FM1", " ", "*", " ", "FM3"}]}], ")"}], "*", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"distance", "[", 
              RowBox[{"i1", ",", "k1"}], "]"}], "+", 
             RowBox[{"distance", "[", 
              RowBox[{"j1", ",", "k1"}], "]"}]}], ")"}], "^", "2"}]}]}], " ", 
        ";", 
        RowBox[{
         RowBox[{"DM23ij", "[", 
          RowBox[{"i1", ",", "j1", ",", "k1"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"EM23ij", " ", "-", 
            RowBox[{"FM2", " ", "*", " ", "FM3"}]}], ")"}], "*", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"distance", "[", 
              RowBox[{"i1", ",", "k1"}], "]"}], "+", 
             RowBox[{"distance", "[", 
              RowBox[{"j1", ",", "k1"}], "]"}]}], ")"}], "^", "2"}]}]}], " ", 
        ";", 
        RowBox[{
         RowBox[{"DM1ij", "[", 
          RowBox[{"i1", ",", "j1", ",", "k1"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"EM1ij", " ", "-", 
            RowBox[{"FM1", "^", "2"}]}], ")"}], "*", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"distance", "[", 
              RowBox[{"i1", ",", "k1"}], "]"}], "+", 
             RowBox[{"distance", "[", 
              RowBox[{"j1", ",", "k1"}], "]"}]}], ")"}], "^", "2"}]}]}], " ", 
        ";", 
        RowBox[{
         RowBox[{"DM2ij", "[", 
          RowBox[{"i1", ",", "j1", ",", "k1"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"EM2ij", " ", "-", 
            RowBox[{"FM2", "^", "2"}]}], ")"}], "*", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"distance", "[", 
              RowBox[{"i1", ",", "k1"}], "]"}], "+", 
             RowBox[{"distance", "[", 
              RowBox[{"j1", ",", "k1"}], "]"}]}], ")"}], "^", "2"}]}]}], ";", 
        RowBox[{
         RowBox[{"DM3ij", "[", 
          RowBox[{"i1", ",", "j1", ",", "k1"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"EM3ij", " ", "-", 
            RowBox[{"FM3", "^", "2"}]}], ")"}], "*", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"distance", "[", 
              RowBox[{"i1", ",", "k1"}], "]"}], "+", 
             RowBox[{"distance", "[", 
              RowBox[{"j1", ",", "k1"}], "]"}]}], ")"}], "^", "2"}]}]}]}]}], 
      "]"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"VDM12ij", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"DM12ij", "[", 
      RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"L", "*", "L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"VDM13ij", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"DM13ij", "[", 
      RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"L", "*", "L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"VDM23ij", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"DM23ij", "[", 
      RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"L", "*", "L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"VDM1ij", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"DM1ij", "[", 
      RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"L", "*", "L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"VDM2ij", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"DM2ij", "[", 
      RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"L", "*", "L", "*", "L"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"VDM3ij", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"DM3ij", "[", 
      RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"L", "*", "L", "*", "L"}], 
    ")"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.768815728314093*^9, 3.7688158377698174`*^9}, {
   3.7688158908634644`*^9, 3.768815894512721*^9}, {3.768815946706793*^9, 
   3.768816095436762*^9}, {3.7688161510092196`*^9, 3.768816167698246*^9}, {
   3.7688164010558004`*^9, 3.768816488430069*^9}, {3.768816599140206*^9, 
   3.7688166360105886`*^9}, {3.768816960082824*^9, 3.7688169999847574`*^9}, {
   3.7688172034775667`*^9, 3.7688173714263678`*^9}, {3.7688254646576405`*^9, 
   3.7688255134893184`*^9}, 3.768825572289236*^9, {3.768825754817062*^9, 
   3.7688257943052*^9}, {3.7688258313255253`*^9, 3.7688258511270666`*^9}, {
   3.7688259281712723`*^9, 3.7688259415608883`*^9}, 3.7688260134085636`*^9, {
   3.768826615603957*^9, 3.768826677452417*^9}, 3.768826737549719*^9, {
   3.768826890464684*^9, 3.7688270427339735`*^9}, {3.768827087170743*^9, 
   3.7688271254514627`*^9}, {3.7688271687617693`*^9, 
   3.7688272068155985`*^9}, {3.768827237647871*^9, 3.7688272452002635`*^9}, {
   3.768924888018335*^9, 3.768924930343129*^9}, {3.768927795257848*^9, 
   3.768927871346518*^9}, {3.768927914252019*^9, 3.7689279328151636`*^9}, {
   3.768927983875762*^9, 3.768928139708346*^9}, {3.768928255210176*^9, 
   3.768928450345991*^9}, {3.768928480703495*^9, 3.7689285573238935`*^9}, {
   3.768928592049314*^9, 3.7689286636901007`*^9}, {3.7689289275820584`*^9, 
   3.768928952280267*^9}, {3.768928985120581*^9, 3.7689290495128336`*^9}, {
   3.769332919632532*^9, 3.7693330218187532`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"9ebe4fdf-80dc-4ba4-9dd2-1f79b4094cce"],

Cell[BoxData[{
 RowBox[{"RD12i", " ", "=", " ", 
  RowBox[{
   RowBox[{"VDM12ij", "/", " ", 
    RowBox[{"Sqrt", "[", "VDM1ij", "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", "VDM2ij", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"RD13i", " ", "=", " ", 
  RowBox[{
   RowBox[{"VDM13ij", "/", " ", 
    RowBox[{"Sqrt", "[", "VDM1ij", "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", "VDM3ij", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"RD23i", " ", "=", " ", 
  RowBox[{
   RowBox[{"VDM23ij", "/", " ", 
    RowBox[{"Sqrt", "[", "VDM2ij", "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", "VDM3ij", "]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.768827534548074*^9, 3.7688275422713904`*^9}, {
  3.768827592272512*^9, 3.768827608159921*^9}, {3.7688277131517878`*^9, 
  3.7688277839099855`*^9}, {3.768929088030429*^9, 3.7689292528227377`*^9}, {
  3.769333030027833*^9, 3.769333036384791*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"2a33c832-eace-4bb9-be8b-a6354886daaa"],

Cell[BoxData[{
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"p", "=", "1"}], ",", 
   RowBox[{"p", "\[LessEqual]", " ", "countI"}], ",", 
   RowBox[{"p", "++"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"DFlowM1", "[", 
      RowBox[{"p", ",", "1"}], "]"}], " ", "=", 
     RowBox[{
      RowBox[{"flowM1", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM1", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"DFlowM1", "[", 
      RowBox[{"p", ",", "2"}], "]"}], "=", 
     RowBox[{
      RowBox[{"flowM1", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM1", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"DFlowM1", "[", 
      RowBox[{"p", ",", "3"}], "]"}], "=", 
     RowBox[{
      RowBox[{"flowM1", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM1", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"DFlowM1", "[", 
      RowBox[{"p", ",", "4"}], "]"}], " ", "=", 
     RowBox[{
      RowBox[{"flowM1", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM1", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"DFlowM1", "[", 
      RowBox[{"p", ",", "5"}], "]"}], "=", 
     RowBox[{
      RowBox[{"flowM1", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM1", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"DFlowM1", "[", 
      RowBox[{"p", ",", "6"}], "]"}], "=", 
     RowBox[{
      RowBox[{"flowM1", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM1", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DFlowM1", "[", 
  RowBox[{"1", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"DFlowM1", "[", 
  RowBox[{"1", ",", "2"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.768800908696782*^9, {3.7688009730770497`*^9, 3.7688010065160723`*^9}, {
   3.7688018348064804`*^9, 3.7688018802497787`*^9}, {3.768929581419794*^9, 
   3.768929595853905*^9}, {3.7689296517182217`*^9, 3.7689296607898874`*^9}, {
   3.7689297302947035`*^9, 3.7689297694360127`*^9}, {3.768929869959466*^9, 
   3.7689298922298393`*^9}, {3.7689299493585463`*^9, 3.7689300434026475`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"b9a27159-560d-4b17-a8dc-90b80b39f78d"],

Cell[BoxData[{
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"p", "=", "1"}], ",", 
   RowBox[{"p", "\[LessEqual]", " ", "countI"}], ",", 
   RowBox[{"p", "++"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"DFlowM2", "[", 
      RowBox[{"p", ",", "1"}], "]"}], " ", "=", 
     RowBox[{
      RowBox[{"flowM2", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM2", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"DFlowM2", "[", 
      RowBox[{"p", ",", "2"}], "]"}], "=", 
     RowBox[{
      RowBox[{"flowM2", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM2", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"DFlowM2", "[", 
      RowBox[{"p", ",", "3"}], "]"}], "=", 
     RowBox[{
      RowBox[{"flowM2", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM2", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"DFlowM2", "[", 
      RowBox[{"p", ",", "4"}], "]"}], " ", "=", 
     RowBox[{
      RowBox[{"flowM2", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM2", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"DFlowM2", "[", 
      RowBox[{"p", ",", "5"}], "]"}], "=", 
     RowBox[{
      RowBox[{"flowM2", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM2", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"DFlowM2", "[", 
      RowBox[{"p", ",", "6"}], "]"}], "=", 
     RowBox[{
      RowBox[{"flowM2", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM2", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DFlowM2", "[", 
  RowBox[{"1", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"DFlowM2", "[", 
  RowBox[{"1", ",", "2"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7687992179855804`*^9, 3.768799266205559*^9}, {
  3.768799397635785*^9, 3.768799408026823*^9}, {3.768799483980545*^9, 
  3.76879952273104*^9}, {3.7687996996245575`*^9, 3.7687997345328827`*^9}, {
  3.7688019270684195`*^9, 3.7688019460093904`*^9}, {3.768930080141077*^9, 
  3.76893014116494*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"f4906788-40f6-4f1d-9d12-2d2de6d0df5e"],

Cell[BoxData[{
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"p", "=", "1"}], ",", 
   RowBox[{"p", "\[LessEqual]", " ", "countI"}], ",", 
   RowBox[{"p", "++"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"DFlowM3", "[", 
      RowBox[{"p", ",", "1"}], "]"}], " ", "=", 
     RowBox[{
      RowBox[{"flowM3", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM3", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"DFlowM3", "[", 
      RowBox[{"p", ",", "2"}], "]"}], "=", 
     RowBox[{
      RowBox[{"flowM3", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM3", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"DFlowM3", "[", 
      RowBox[{"p", ",", "3"}], "]"}], "=", 
     RowBox[{
      RowBox[{"flowM3", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM3", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"DFlowM3", "[", 
      RowBox[{"p", ",", "4"}], "]"}], " ", "=", 
     RowBox[{
      RowBox[{"flowM3", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM3", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"DFlowM3", "[", 
      RowBox[{"p", ",", "5"}], "]"}], "=", 
     RowBox[{
      RowBox[{"flowM3", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM3", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"DFlowM3", "[", 
      RowBox[{"p", ",", "6"}], "]"}], "=", 
     RowBox[{
      RowBox[{"flowM3", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "1"}], "]"}]}], "]"}], "-", 
      RowBox[{"flowM3", "[", 
       RowBox[{
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "3"}], "]"}], ",", 
        RowBox[{"pIndex", "[", 
         RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DFlowM3", "[", 
  RowBox[{"1", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"DFlowM3", "[", 
  RowBox[{"1", ",", "2"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7689292938501315`*^9, 3.768929332725568*^9}, {
  3.7689293942481894`*^9, 3.7689293966610346`*^9}, {3.768930156880433*^9, 
  3.7689302153964825`*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"8c74b5c2-767e-4a6e-8c0a-a782099cf25c"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", " ", "L"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", " ", "=", " ", 
       RowBox[{"i", "+", "1"}]}], ",", " ", 
      RowBox[{"j", " ", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j", "++"}], ",", " ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", " ", 
        RowBox[{"k", "\[LessEqual]", " ", "L"}], ",", " ", 
        RowBox[{"k", "++"}], ",", " ", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"p", "=", "1"}], ",", 
          RowBox[{"p", "\[LessEqual]", " ", "countI"}], ",", 
          RowBox[{"p", "++"}], ",", 
          RowBox[{
           RowBox[{"D1213", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "-", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"distance", "[", 
                RowBox[{"i", ",", "j"}], "]"}], "-", 
               RowBox[{"distance", "[", 
                RowBox[{"i", ",", "k"}], "]"}]}], ")"}], "*", 
             RowBox[{"DFlowM1", "[", 
              RowBox[{"p", ",", "1"}], "]"}]}]}], ";", " ", 
           RowBox[{"D1221", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"D1232", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "-", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"distance", "[", 
                RowBox[{"i", ",", "j"}], "]"}], "-", 
               RowBox[{"distance", "[", 
                RowBox[{"k", ",", "j"}], "]"}]}], ")"}], "*", 
             RowBox[{"DFlowM1", "[", 
              RowBox[{"p", ",", "2"}], "]"}]}]}], ";", " ", 
           RowBox[{"D1323", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "-", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"distance", "[", 
                RowBox[{"i", ",", "k"}], "]"}], "-", 
               RowBox[{"distance", "[", 
                RowBox[{"j", ",", "k"}], "]"}]}], ")"}], "*", 
             RowBox[{"DFlowM1", "[", 
              RowBox[{"p", ",", "3"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"D1331", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"D2123", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "-", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"distance", "[", 
                RowBox[{"j", ",", "i"}], "]"}], "-", 
               RowBox[{"distance", "[", 
                RowBox[{"j", ",", "k"}], "]"}]}], ")"}], "*", " ", 
             RowBox[{"DFlowM1", "[", 
              RowBox[{"p", ",", "4"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"D2131", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "-", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"distance", "[", 
                RowBox[{"j", ",", "i"}], "]"}], "-", 
               RowBox[{"distance", "[", 
                RowBox[{"k", ",", "i"}], "]"}]}], ")"}], " ", "*", " ", 
             RowBox[{"DFlowM1", "[", 
              RowBox[{"p", ",", "5"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"D3132", " ", "=", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "-", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"distance", "[", 
                RowBox[{"k", ",", "i"}], "]"}], "-", 
               RowBox[{"distance", "[", 
                RowBox[{"k", ",", "j"}], "]"}]}], ")"}], "*", " ", 
             RowBox[{"DFlowM1", "[", 
              RowBox[{"p", ",", "6"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"D2332", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"E2", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"N1", "-", "D1213", "-", "D1232"}], ",", "D1213", ",",
                 "D1221", ",", "0", ",", "0", ",", "D1232"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "D1213"}], ",", 
                RowBox[{"N1", "+", "D1213", "-", "D1323"}], ",", "0", ",", 
                "D1323", ",", "D1331", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "D1221"}], ",", "0", ",", 
                RowBox[{"N1", "-", "D2123", "-", "D2131"}], ",", "D2123", ",",
                 "D2131", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "D1323"}], ",", 
                RowBox[{"-", "D2123"}], ",", 
                RowBox[{"N1", "+", "D1323", "+", "D2123"}], ",", "0", ",", 
                "D2332"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "D1331"}], ",", 
                RowBox[{"-", "D2123"}], ",", "0", ",", 
                RowBox[{"N1", "+", "D2123", "-", "D3132"}], ",", "D3132"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "D1232"}], ",", "0", ",", "0", ",", 
                RowBox[{"-", "D2332"}], ",", 
                RowBox[{"-", "D3132"}], ",", 
                RowBox[{"N1", "+", "D1232", "+", "D3132"}]}], "}"}]}], 
             "}"}]}], ";", 
           RowBox[{"F2", " ", "=", " ", 
            RowBox[{"N1", " ", 
             RowBox[{"IdentityMatrix", "[", "6", "]"}]}]}], ";", " ", 
           RowBox[{"T2", " ", "=", " ", 
            RowBox[{"Dot", "[", 
             RowBox[{
              RowBox[{"Inverse", "[", "F2", "]"}], ",", "E2"}], "]"}]}], ";", 
           " ", 
           RowBox[{"EF2", " ", "=", " ", 
            RowBox[{"Eigenvalues", "[", "T2", "]"}]}], ";", " ", 
           RowBox[{
            RowBox[{"lambda1", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
            " ", "=", " ", 
            RowBox[{"EF2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"lambda1", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
            " ", "=", " ", 
            RowBox[{"EF2", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"lambda1", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
            " ", "=", " ", 
            RowBox[{"EF2", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"lambda1", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
            " ", "=", " ", 
            RowBox[{"EF2", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"lambda1", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
            " ", "=", " ", 
            RowBox[{"EF2", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"lambda1", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
            " ", "=", " ", 
            RowBox[{"EF2", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"EFA1", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "p"}], "]"}], " ", "=", 
            " ", "EF2"}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7688011694822383`*^9, 3.768801177656339*^9}, {
   3.7688012694664907`*^9, 3.76880129511024*^9}, {3.7688013301755013`*^9, 
   3.768801405530501*^9}, {3.7688015071709566`*^9, 3.7688015103914237`*^9}, {
   3.7688021303073564`*^9, 3.768802166650997*^9}, {3.7688022510746775`*^9, 
   3.768802251618414*^9}, {3.7688059550737257`*^9, 3.7688060202216063`*^9}, {
   3.768954964996477*^9, 3.768954976071186*^9}, {3.768955069127763*^9, 
   3.7689551355370398`*^9}, {3.768955169703712*^9, 3.7689551698296633`*^9}, 
   3.7689552698778696`*^9, {3.769354883458028*^9, 3.769354896325878*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"6b8f5418-fad9-4f76-b03e-0e39dea86b8c"],

Cell[BoxData[{
 RowBox[{"EFA1", "[", 
  RowBox[{"1", ",", "2", ",", "3", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"EFA1", "[", 
  RowBox[{"1", ",", "2", ",", "4", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"EFA1", "[", 
  RowBox[{"1", ",", "2", ",", "5", ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7688041009897947`*^9, 3.768804112197439*^9}, {
   3.768805053173047*^9, 3.768805060577505*^9}, {3.7688051817846127`*^9, 
   3.7688051839505806`*^9}, 3.7688052829842806`*^9, {3.7688053137146044`*^9, 
   3.7688053861400127`*^9}, {3.768805427019498*^9, 3.7688054314953527`*^9}, {
   3.768805566793158*^9, 3.7688055817270374`*^9}, {3.7688056363959208`*^9, 
   3.7688056374814014`*^9}, {3.7688057594601455`*^9, 3.768805771216539*^9}, {
   3.7688058484056616`*^9, 3.768805891719987*^9}, {3.76880618673208*^9, 
   3.7688061884362774`*^9}, {3.7688062484576054`*^9, 3.768806249340191*^9}},
 CellLabel->
  "In[774]:=",ExpressionUUID->"9de3d4b6-8369-44b5-bb7f-35f23cacdbd2"],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", " ", "L"}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", " ", "=", " ", 
      RowBox[{"i", "+", "1"}]}], ",", " ", 
     RowBox[{"j", " ", "\[LessEqual]", " ", "L"}], ",", " ", 
     RowBox[{"j", "++"}], ",", " ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", " ", 
       RowBox[{"k", "\[LessEqual]", " ", "L"}], ",", " ", 
       RowBox[{"k", "++"}], ",", " ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"p", "=", "1"}], ",", 
         RowBox[{"p", "\[LessEqual]", " ", "countI"}], ",", 
         RowBox[{"p", "++"}], ",", 
         RowBox[{
          RowBox[{"D1213", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"L", "-", "2"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"distance", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "-", 
              RowBox[{"distance", "[", 
               RowBox[{"i", ",", "k"}], "]"}]}], ")"}], "*", 
            RowBox[{"DFlowM2", "[", 
             RowBox[{"p", ",", "1"}], "]"}]}]}], ";", " ", 
          RowBox[{"D1221", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"D1232", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"L", "-", "2"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"distance", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "-", 
              RowBox[{"distance", "[", 
               RowBox[{"k", ",", "j"}], "]"}]}], ")"}], "*", 
            RowBox[{"DFlowM2", "[", 
             RowBox[{"p", ",", "2"}], "]"}]}]}], ";", " ", 
          RowBox[{"D1323", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"L", "-", "2"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"distance", "[", 
               RowBox[{"i", ",", "k"}], "]"}], "-", 
              RowBox[{"distance", "[", 
               RowBox[{"j", ",", "k"}], "]"}]}], ")"}], "*", 
            RowBox[{"DFlowM2", "[", 
             RowBox[{"p", ",", "3"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"D1331", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"D2123", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"L", "-", "2"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"distance", "[", 
               RowBox[{"j", ",", "i"}], "]"}], "-", 
              RowBox[{"distance", "[", 
               RowBox[{"j", ",", "k"}], "]"}]}], ")"}], "*", " ", 
            RowBox[{"DFlowM2", "[", 
             RowBox[{"p", ",", "4"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"D2131", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"L", "-", "2"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"distance", "[", 
               RowBox[{"j", ",", "i"}], "]"}], "-", 
              RowBox[{"distance", "[", 
               RowBox[{"k", ",", "i"}], "]"}]}], ")"}], " ", "*", " ", 
            RowBox[{"DFlowM2", "[", 
             RowBox[{"p", ",", "5"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"D3132", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"L", "-", "2"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"distance", "[", 
               RowBox[{"k", ",", "i"}], "]"}], "-", 
              RowBox[{"distance", "[", 
               RowBox[{"k", ",", "j"}], "]"}]}], ")"}], "*", " ", 
            RowBox[{"DFlowM2", "[", 
             RowBox[{"p", ",", "6"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"D2332", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"E2", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"N1", "-", "D1213", "-", "D1232"}], ",", "D1213", ",", 
               "D1221", ",", "0", ",", "0", ",", "D1232"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "D1213"}], ",", 
               RowBox[{"N1", "+", "D1213", "-", "D1323"}], ",", "0", ",", 
               "D1323", ",", "D1331", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "D1221"}], ",", "0", ",", 
               RowBox[{"N1", "-", "D2123", "-", "D2131"}], ",", "D2123", ",", 
               "D2131", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "D1323"}], ",", 
               RowBox[{"-", "D2123"}], ",", 
               RowBox[{"N1", "+", "D1323", "+", "D2123"}], ",", "0", ",", 
               "D2332"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "D1331"}], ",", 
               RowBox[{"-", "D2123"}], ",", "0", ",", 
               RowBox[{"N1", "+", "D2123", "-", "D3132"}], ",", "D3132"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "D1232"}], ",", "0", ",", "0", ",", 
               RowBox[{"-", "D2332"}], ",", 
               RowBox[{"-", "D3132"}], ",", 
               RowBox[{"N1", "+", "D1232", "+", "D3132"}]}], "}"}]}], "}"}]}],
           ";", 
          RowBox[{"F2", " ", "=", " ", 
           RowBox[{"N1", " ", 
            RowBox[{"IdentityMatrix", "[", "6", "]"}]}]}], ";", " ", 
          RowBox[{"T2", " ", "=", " ", 
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{"Inverse", "[", "F2", "]"}], ",", "E2"}], "]"}]}], ";", 
          " ", 
          RowBox[{"EF2", " ", "=", " ", 
           RowBox[{"Eigenvalues", "[", "T2", "]"}]}], ";", " ", 
          RowBox[{
           RowBox[{"lambda2", "[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], " ",
            "=", " ", 
           RowBox[{"EF2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"lambda2", "[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], " ",
            "=", " ", 
           RowBox[{"EF2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"lambda2", "[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], " ",
            "=", " ", 
           RowBox[{"EF2", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"lambda2", "[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], " ",
            "=", " ", 
           RowBox[{"EF2", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"lambda2", "[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], " ",
            "=", " ", 
           RowBox[{"EF2", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"lambda2", "[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], " ",
            "=", " ", 
           RowBox[{"EF2", "[", 
            RowBox[{"[", "6", "]"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"EFA2", "[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "p"}], "]"}], " ", "=", " ",
            "EF2"}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7687599394034576`*^9, 3.768759969004328*^9}, {
   3.7687600048192177`*^9, 3.7687600075779066`*^9}, {3.768761598188235*^9, 
   3.768761701449919*^9}, {3.768761748580413*^9, 3.7687617797385283`*^9}, {
   3.768761851443282*^9, 3.7687618835709395`*^9}, {3.768762031554268*^9, 
   3.768762045215746*^9}, {3.768762212073045*^9, 3.7687622775547733`*^9}, {
   3.7687623107948985`*^9, 3.7687623526748962`*^9}, {3.7687989899195156`*^9, 
   3.768798994186469*^9}, {3.7687990408102036`*^9, 3.7687990525476093`*^9}, {
   3.7687994393538623`*^9, 3.768799462072011*^9}, {3.768799625361026*^9, 
   3.768799633862968*^9}, {3.7687997222907276`*^9, 3.768799757006152*^9}, {
   3.768799901167302*^9, 3.7687999093174105`*^9}, {3.7688005637198787`*^9, 
   3.7688005656989355`*^9}, 3.7688006058427553`*^9, {3.7688006706518126`*^9, 
   3.7688006915138383`*^9}, {3.76880082602827*^9, 3.768800871640486*^9}, {
   3.7688013047836294`*^9, 3.768801304878585*^9}, {3.768802178548317*^9, 
   3.7688022036673183`*^9}, {3.768802254906848*^9, 3.7688022554425993`*^9}, {
   3.7689552592289524`*^9, 3.76895534452522*^9}, {3.769354913241797*^9, 
   3.769354923341969*^9}},
 CellLabel->
  "In[777]:=",ExpressionUUID->"43df0877-b359-4b45-baea-d883952d63e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", " ", "L"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", " ", "=", " ", 
       RowBox[{"i", "+", "1"}]}], ",", " ", 
      RowBox[{"j", " ", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j", "++"}], ",", " ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", " ", 
        RowBox[{"k", "\[LessEqual]", " ", "L"}], ",", " ", 
        RowBox[{"k", "++"}], ",", " ", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"p", "=", "1"}], ",", 
          RowBox[{"p", "\[LessEqual]", " ", "countI"}], ",", 
          RowBox[{"p", "++"}], ",", 
          RowBox[{
           RowBox[{"D1213", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "-", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"distance", "[", 
                RowBox[{"i", ",", "j"}], "]"}], "-", 
               RowBox[{"distance", "[", 
                RowBox[{"i", ",", "k"}], "]"}]}], ")"}], "*", 
             RowBox[{"DFlowM3", "[", 
              RowBox[{"p", ",", "1"}], "]"}]}]}], ";", " ", 
           RowBox[{"D1221", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"D1232", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "-", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"distance", "[", 
                RowBox[{"i", ",", "j"}], "]"}], "-", 
               RowBox[{"distance", "[", 
                RowBox[{"k", ",", "j"}], "]"}]}], ")"}], "*", 
             RowBox[{"DFlowM3", "[", 
              RowBox[{"p", ",", "2"}], "]"}]}]}], ";", " ", 
           RowBox[{"D1323", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "-", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"distance", "[", 
                RowBox[{"i", ",", "k"}], "]"}], "-", 
               RowBox[{"distance", "[", 
                RowBox[{"j", ",", "k"}], "]"}]}], ")"}], "*", 
             RowBox[{"DFlowM3", "[", 
              RowBox[{"p", ",", "3"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"D1331", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"D2123", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "-", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"distance", "[", 
                RowBox[{"j", ",", "i"}], "]"}], "-", 
               RowBox[{"distance", "[", 
                RowBox[{"j", ",", "k"}], "]"}]}], ")"}], "*", " ", 
             RowBox[{"DFlowM3", "[", 
              RowBox[{"p", ",", "4"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"D2131", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "-", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"distance", "[", 
                RowBox[{"j", ",", "i"}], "]"}], "-", 
               RowBox[{"distance", "[", 
                RowBox[{"k", ",", "i"}], "]"}]}], ")"}], " ", "*", " ", 
             RowBox[{"DFlowM3", "[", 
              RowBox[{"p", ",", "5"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"D3132", " ", "=", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "-", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"distance", "[", 
                RowBox[{"k", ",", "i"}], "]"}], "-", 
               RowBox[{"distance", "[", 
                RowBox[{"k", ",", "j"}], "]"}]}], ")"}], "*", " ", 
             RowBox[{"DFlowM3", "[", 
              RowBox[{"p", ",", "6"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"D2332", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"E2", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"N1", "-", "D1213", "-", "D1232"}], ",", "D1213", ",",
                 "D1221", ",", "0", ",", "0", ",", "D1232"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "D1213"}], ",", 
                RowBox[{"N1", "+", "D1213", "-", "D1323"}], ",", "0", ",", 
                "D1323", ",", "D1331", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "D1221"}], ",", "0", ",", 
                RowBox[{"N1", "-", "D2123", "-", "D2131"}], ",", "D2123", ",",
                 "D2131", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "D1323"}], ",", 
                RowBox[{"-", "D2123"}], ",", 
                RowBox[{"N1", "+", "D1323", "+", "D2123"}], ",", "0", ",", 
                "D2332"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "D1331"}], ",", 
                RowBox[{"-", "D2123"}], ",", "0", ",", 
                RowBox[{"N1", "+", "D2123", "-", "D3132"}], ",", "D3132"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "D1232"}], ",", "0", ",", "0", ",", 
                RowBox[{"-", "D2332"}], ",", 
                RowBox[{"-", "D3132"}], ",", 
                RowBox[{"N1", "+", "D1232", "+", "D3132"}]}], "}"}]}], 
             "}"}]}], ";", 
           RowBox[{"F2", " ", "=", " ", 
            RowBox[{"N1", " ", 
             RowBox[{"IdentityMatrix", "[", "6", "]"}]}]}], ";", " ", 
           RowBox[{"T2", " ", "=", " ", 
            RowBox[{"Dot", "[", 
             RowBox[{
              RowBox[{"Inverse", "[", "F2", "]"}], ",", "E2"}], "]"}]}], ";", 
           " ", 
           RowBox[{"EF2", " ", "=", " ", 
            RowBox[{"Eigenvalues", "[", "T2", "]"}]}], ";", " ", 
           RowBox[{
            RowBox[{"lambda3", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
            " ", "=", " ", 
            RowBox[{"EF2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"lambda3", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
            " ", "=", " ", 
            RowBox[{"EF2", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"lambda3", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
            " ", "=", " ", 
            RowBox[{"EF2", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"lambda3", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
            " ", "=", " ", 
            RowBox[{"EF2", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"lambda3", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
            " ", "=", " ", 
            RowBox[{"EF2", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"lambda3", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
            " ", "=", " ", 
            RowBox[{"EF2", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"EFA3", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "p"}], "]"}], " ", "=", 
            " ", "EF2"}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], 
  "\n"}]], "Input",
 CellChangeTimes->{{3.7689553675682077`*^9, 3.7689554072902465`*^9}, {
  3.7693549290252724`*^9, 3.7693549392373943`*^9}},
 CellLabel->
  "In[778]:=",ExpressionUUID->"6ad04df6-17bd-4a39-bf24-74cd42afee66"],

Cell[BoxData[
 RowBox[{"d1", " ", "=", " ", "1"}]], "Input",
 CellChangeTimes->{{3.7688286388816576`*^9, 3.768828688797818*^9}, {
   3.7688287233593073`*^9, 3.7688287823481493`*^9}, {3.768829172666725*^9, 
   3.768829189105873*^9}, {3.76882998361042*^9, 3.7688299940494556`*^9}, 
   3.7688301142840147`*^9, {3.7688301602910395`*^9, 3.7688301896940002`*^9}, {
   3.768830277054286*^9, 3.7688304793876534`*^9}, {3.768832631986581*^9, 
   3.768832645677043*^9}, {3.768832746170046*^9, 3.768832809511795*^9}, {
   3.768832955539057*^9, 3.7688330565528116`*^9}, {3.7689186349867353`*^9, 
   3.7689186409348927`*^9}},
 CellLabel->
  "In[779]:=",ExpressionUUID->"d26b95fc-6c3b-4ab7-adb0-191c8a43526e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"compute", " ", "the", " ", "mean", " ", "in", " ", "a", " ", 
     RowBox[{"neighbourhood", " ", "--"}]}], ">", " ", 
    RowBox[{"the", " ", "first", " ", "objective"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", 
       RowBox[{"i", "+", "1"}]}], ",", 
      RowBox[{"j", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j", "++"}], ",", " ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"j", "+", "1"}]}], ",", 
        RowBox[{"k", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "3", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "4", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "5", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "6", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "3", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "4", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "5", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "6", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7688286388816576`*^9, 3.768828688797818*^9}, {
   3.7688287233593073`*^9, 3.7688287823481493`*^9}, {3.768829172666725*^9, 
   3.768829189105873*^9}, {3.76882998361042*^9, 3.7688299940494556`*^9}, 
   3.7688301142840147`*^9, {3.7688301602910395`*^9, 3.7688301896940002`*^9}, {
   3.768830277054286*^9, 3.7688304793876534`*^9}, {3.768832631986581*^9, 
   3.768832645677043*^9}, {3.768832746170046*^9, 3.768832809511795*^9}, {
   3.768832955539057*^9, 3.7688330405664415`*^9}, {3.7688442319782476`*^9, 
   3.7688442669145627`*^9}, {3.7688639197392883`*^9, 3.768864153857487*^9}, {
   3.768864192146189*^9, 3.76886420550581*^9}, {3.768864242972912*^9, 
   3.7688642652052937`*^9}, {3.768864318033066*^9, 3.768864456332018*^9}, {
   3.768864730822919*^9, 3.7688647410160513`*^9}, {3.7689173780330462`*^9, 
   3.768917393151825*^9}, 3.768918156157432*^9, {3.7689182571252117`*^9, 
   3.768918272682782*^9}, {3.768920145877163*^9, 3.7689201678796606`*^9}, {
   3.768920698607174*^9, 3.7689207130612803`*^9}, {3.768920754239608*^9, 
   3.7689207726527963`*^9}, {3.768957412167133*^9, 3.7689574166180153`*^9}, {
   3.768957560292378*^9, 3.7689575981383233`*^9}, {3.7689576681788692`*^9, 
   3.768957668848545*^9}, {3.768957699210043*^9, 3.768957701744836*^9}, {
   3.768957741250964*^9, 3.7689578261544123`*^9}, {3.7689578593065853`*^9, 
   3.7689578908965006`*^9}, {3.7689579370814433`*^9, 3.768957948288083*^9}, {
   3.7689580129781857`*^9, 3.768958117788133*^9}, {3.7689604978152514`*^9, 
   3.7689605019722652`*^9}, {3.768960565199068*^9, 3.7689605686524167`*^9}},
 CellLabel->
  "In[780]:=",ExpressionUUID->"5ba2a021-78b9-43cc-81b9-e2e2d2b01d36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EEL1ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"EL1ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EEL2ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"EL2ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"EEL21ij", "[", "d1", "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
       RowBox[{"(", 
        RowBox[{"L", "-", "1"}], ")"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7688286388816576`*^9, 3.768828688797818*^9}, {
   3.7688287233593073`*^9, 3.7688287823481493`*^9}, {3.768829172666725*^9, 
   3.768829189105873*^9}, {3.76882998361042*^9, 3.7688299940494556`*^9}, 
   3.7688301142840147`*^9, {3.7688301602910395`*^9, 3.7688301896940002`*^9}, {
   3.768830277054286*^9, 3.7688304793876534`*^9}, {3.768832631986581*^9, 
   3.768832645677043*^9}, {3.768832746170046*^9, 3.768832809511795*^9}, {
   3.768832955539057*^9, 3.7688330405664415`*^9}, {3.7688442319782476`*^9, 
   3.7688442669145627`*^9}, {3.7688639197392883`*^9, 3.768864153857487*^9}, {
   3.768864192146189*^9, 3.76886420550581*^9}, {3.768864242972912*^9, 
   3.7688642652052937`*^9}, {3.768864318033066*^9, 3.768864456332018*^9}, {
   3.768864730822919*^9, 3.7688647410160513`*^9}, {3.7689173780330462`*^9, 
   3.768917393151825*^9}, {3.76891743871207*^9, 3.7689174538118706`*^9}, {
   3.7689177633260345`*^9, 3.7689178055518684`*^9}, {3.768917927497623*^9, 
   3.768918017554613*^9}, {3.7689180534694633`*^9, 3.7689180866066475`*^9}},
 CellLabel->
  "In[781]:=",ExpressionUUID->"a12e4975-35d1-4aad-af40-7609160158bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"compute", " ", "the", " ", "mean", " ", "in", " ", "a", " ", 
     RowBox[{"neighbourhood", " ", "--"}]}], ">", " ", 
    RowBox[{"the", " ", "first", " ", "objective"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", 
       RowBox[{"i", "+", "1"}]}], ",", 
      RowBox[{"j", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j", "++"}], ",", " ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"j", "+", "1"}]}], ",", 
        RowBox[{"k", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "3", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "4", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "5", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "6", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7689556501062827`*^9, 3.7689556691791677`*^9}, {
   3.768955720081868*^9, 3.768956061999574*^9}, {3.7689567110359898`*^9, 
   3.7689567407228117`*^9}, {3.7689582097961807`*^9, 3.768958389464384*^9}, {
   3.768958439359553*^9, 3.7689584733283195`*^9}, 3.768958524818725*^9, {
   3.768958564532761*^9, 3.7689586614154997`*^9}, {3.7689610288256483`*^9, 
   3.76896103507966*^9}, {3.7689611090413275`*^9, 3.768961119319418*^9}, {
   3.768961159505234*^9, 3.7689611648566732`*^9}, 3.7693332231336007`*^9},
 CellLabel->
  "In[783]:=",ExpressionUUID->"3bc5560b-d600-4f37-9178-434db6e4f4d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EEL3ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"EL3ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}]], "Input",
 CellChangeTimes->{{3.7689608341646004`*^9, 3.7689608936332035`*^9}, {
  3.769333229713462*^9, 3.7693332310398264`*^9}},
 CellLabel->
  "In[784]:=",ExpressionUUID->"9a2c17c4-8f57-4f29-9714-f8c38d31ec41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.768830516425952*^9, {3.7688305730559187`*^9, 3.7688305797267246`*^9}, {
   3.7688306305684433`*^9, 3.768830762061643*^9}, 3.768830793328706*^9, {
   3.7688308242939296`*^9, 3.7688308834546666`*^9}, {3.7688309706490245`*^9, 
   3.768831052133102*^9}, {3.7688311158076963`*^9, 3.768831118599371*^9}, {
   3.7688311508289757`*^9, 3.768831161318959*^9}, 3.768831244930024*^9, {
   3.7688312787818604`*^9, 3.7688314479950576`*^9}, {3.7688318512664523`*^9, 
   3.768831936806594*^9}, {3.76883215088535*^9, 3.7688321514840655`*^9}, 
   3.768917486230375*^9, {3.7689186003152895`*^9, 3.768918605343915*^9}, {
   3.768918856096136*^9, 3.76891887524299*^9}, {3.7689190833605957`*^9, 
   3.7689191873209496`*^9}, {3.7689192829902544`*^9, 
   3.7689193740237913`*^9}, {3.768919442504073*^9, 3.768919472413789*^9}, {
   3.768919527959263*^9, 3.7689196816778517`*^9}, {3.7689197144791946`*^9, 
   3.768919748685841*^9}, {3.768919917438258*^9, 3.7689199449331207`*^9}, {
   3.768919978869915*^9, 3.768920093909971*^9}, {3.7689201893593793`*^9, 
   3.768920195503444*^9}, {3.7689203744449835`*^9, 3.768920382643068*^9}, {
   3.768920422916833*^9, 3.7689204384913893`*^9}, {3.7689205074704676`*^9, 
   3.768920522287385*^9}, {3.768920596484939*^9, 3.768920612156472*^9}, {
   3.7689208159111567`*^9, 3.768920909917262*^9}, {3.7689209772670946`*^9, 
   3.768921236737159*^9}, {3.7689212767850533`*^9, 3.768921356760851*^9}, {
   3.768921409725561*^9, 3.768921460349374*^9}, {3.7689214983902063`*^9, 
   3.768921804612959*^9}, {3.768921842466872*^9, 3.7689221041358957`*^9}, {
   3.7689221342605176`*^9, 3.7689221893082247`*^9}, 3.768922556865692*^9, {
   3.7689587990817537`*^9, 3.7689588094348135`*^9}, {3.7689588652461615`*^9, 
   3.7689588747366295`*^9}, {3.7689589360223465`*^9, 
   3.7689589534580183`*^9}, {3.768958983517679*^9, 3.768959013652279*^9}, {
   3.768959068142255*^9, 3.7689590846213865`*^9}, {3.768959140723585*^9, 
   3.7689591482260103`*^9}, {3.7689595265533276`*^9, 
   3.7689595572956343`*^9}, {3.768959688483985*^9, 3.7689597427910395`*^9}, {
   3.768959863543371*^9, 3.768959899989964*^9}, {3.768959985250247*^9, 
   3.7689600292772255`*^9}, {3.7689600671131577`*^9, 3.768960110651366*^9}, {
   3.7689603137871385`*^9, 3.7689603229817505`*^9}, {3.7689612328212137`*^9, 
   3.768961237585944*^9}, {3.76896153388643*^9, 3.768961555778976*^9}, {
   3.768961586042514*^9, 3.76896162854222*^9}},
 CellLabel->
  "In[785]:=",ExpressionUUID->"b5ded720-26a0-4e96-aa31-8ebc8ff7fdb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.768956799497743*^9, 3.7689572992550583`*^9}, {
  3.768957337530775*^9, 3.768957378691115*^9}, {3.768961724408435*^9, 
  3.768961812479373*^9}, {3.768961869087338*^9, 3.768961939411748*^9}, {
  3.7689619867181587`*^9, 3.7689621582122607`*^9}, {3.7689622108341236`*^9, 
  3.7689622910478134`*^9}, {3.768962325029589*^9, 3.768962462715829*^9}, {
  3.769333255887967*^9, 3.769333258468734*^9}},
 CellLabel->
  "In[786]:=",ExpressionUUID->"84e4cefc-0461-4139-83c6-0385817de101"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7689625878410664`*^9, 3.7689626494636326`*^9}, {
   3.768962687088668*^9, 3.7689626980904083`*^9}, {3.7689627527223167`*^9, 
   3.7689628100319595`*^9}, {3.7689628444585094`*^9, 
   3.7689628684180727`*^9}, {3.7689629339437723`*^9, 
   3.7689629691349764`*^9}, {3.7689630113518047`*^9, 3.768963142094364*^9}, {
   3.7689631869739265`*^9, 3.768963212685636*^9}, {3.7689632504486103`*^9, 
   3.7689633005526867`*^9}, 3.769333298383662*^9},
 CellLabel->
  "In[787]:=",ExpressionUUID->"8ae8a940-dcf0-40e0-89b0-c295764b7552"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7689633597813826`*^9, 3.768963418323419*^9}, {
   3.7689634539924045`*^9, 3.7689636685529284`*^9}, {3.7689637253238134`*^9, 
   3.768963798637806*^9}, {3.768963854734025*^9, 3.7689638783427315`*^9}, {
   3.769260267909713*^9, 3.769260317692955*^9}, 3.769333326455256*^9},
 CellLabel->
  "In[788]:=",ExpressionUUID->"53bb2e78-3aa3-414b-9ed6-982a01f16057"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VEL11ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL11ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL22ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL22ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL33ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL33ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL12ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL12ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL13ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL13ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL23ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL23ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}]}], "Input",
 CellChangeTimes->{
  3.768830516425952*^9, {3.7688305730559187`*^9, 3.7688305797267246`*^9}, {
   3.7688306305684433`*^9, 3.768830762061643*^9}, 3.768830793328706*^9, {
   3.7688308242939296`*^9, 3.7688308834546666`*^9}, {3.7688309706490245`*^9, 
   3.768831052133102*^9}, {3.7688311158076963`*^9, 3.768831118599371*^9}, {
   3.7688311508289757`*^9, 3.768831161318959*^9}, 3.768831244930024*^9, {
   3.7688312787818604`*^9, 3.7688314479950576`*^9}, {3.7688318512664523`*^9, 
   3.768831936806594*^9}, {3.76883215088535*^9, 3.7688321514840655`*^9}, {
   3.768917486230375*^9, 3.768917527266776*^9}, {3.768922269897729*^9, 
   3.7689223944512444`*^9}, {3.7689648469111423`*^9, 
   3.7689650058352413`*^9}, {3.769333345532133*^9, 3.76933335393614*^9}},
 CellLabel->
  "In[789]:=",ExpressionUUID->"3478ed55-5c15-47bd-83f9-eb2cfe28829a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RL12i", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"VEL12ij", "[", "d1", "]"}], "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"VEL11ij", "[", "d1", "]"}], "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"VEL22ij", "[", "d1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RL13i", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"VEL13ij", "[", "d1", "]"}], "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"VEL11ij", "[", "d1", "]"}], "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"VEL33ij", "[", "d1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RL23i", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"VEL23ij", "[", "d1", "]"}], "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"VEL22ij", "[", "d1", "]"}], "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"VEL33ij", "[", "d1", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.768832062873379*^9, 3.7688321605017557`*^9}, {
  3.7689650169269485`*^9, 3.76896510459737*^9}, {3.7689651351157937`*^9, 
  3.7689651947013445`*^9}, {3.769333358081149*^9, 3.76933336460802*^9}},
 CellLabel->
  "In[795]:=",ExpressionUUID->"8cfe522d-b29a-4d78-90bc-510355b4964e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"d1", " ", "=", " ", "2"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7689226465098653`*^9, 3.7689226535914793`*^9}},
 CellLabel->
  "In[798]:=",ExpressionUUID->"7b8e40ea-d60f-4c63-ab1c-87e2d91c5831"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"compute", " ", "the", " ", "mean", " ", "in", " ", "a", " ", 
     RowBox[{"neighbourhood", " ", "--"}]}], ">", " ", 
    RowBox[{"the", " ", "first", " ", "objective"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", 
       RowBox[{"i", "+", "1"}]}], ",", 
      RowBox[{"j", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j", "++"}], ",", " ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"j", "+", "1"}]}], ",", 
        RowBox[{"k", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "3", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "5", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "4", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "6", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "3", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "5", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "4", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "6", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7689226622703342`*^9},
 CellLabel->
  "In[799]:=",ExpressionUUID->"749a9d1f-622d-41dc-8dc6-9c4484699011"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EEL1ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"EL1ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EEL2ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"EL2ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"EEL21ij", "[", "d1", "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
       RowBox[{"(", 
        RowBox[{"L", "-", "1"}], ")"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{3.768922690333933*^9},
 CellLabel->
  "In[800]:=",ExpressionUUID->"7e771288-603e-473a-b818-bd5a1751e96a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"compute", " ", "the", " ", "mean", " ", "in", " ", "a", " ", 
     RowBox[{"neighbourhood", " ", "--"}]}], ">", " ", 
    RowBox[{"the", " ", "first", " ", "objective"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", 
       RowBox[{"i", "+", "1"}]}], ",", 
      RowBox[{"j", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j", "++"}], ",", " ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"j", "+", "1"}]}], ",", 
        RowBox[{"k", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "3", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "4", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "5", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "6", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7692665882192197`*^9, 3.7693333926116447`*^9},
 CellLabel->
  "In[802]:=",ExpressionUUID->"77ed36e2-63d2-491b-878a-30851d5b3f80"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EEL3ij", "[", "d1", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"EL3ij", "[", 
          RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
      RowBox[{"(", 
       RowBox[{"L", "-", "1"}], ")"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{3.7692666348519487`*^9, 3.769333397567295*^9},
 CellLabel->
  "In[803]:=",ExpressionUUID->"77c5ea62-da9c-46bf-ad69-411817958612"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[804]:=",ExpressionUUID->"34f81a25-2c83-430e-a4a0-0f013e3e7e85"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7692616611354856`*^9, 3.769333417518755*^9},
 CellLabel->
  "In[805]:=",ExpressionUUID->"772a03d1-64a4-4330-a478-4f9e37b80f89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7692617076223087`*^9, 3.7693334443599358`*^9},
 CellLabel->
  "In[806]:=",ExpressionUUID->"4a570776-015c-4638-adc2-1fc201b1a33b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.76926179646288*^9, 3.7693334777509813`*^9},
 CellLabel->
  "In[807]:=",ExpressionUUID->"82a948c6-5659-4bb9-b3df-63dff8687b06"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VEL11ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL11ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL22ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL22ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL33ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL33ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL12ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL12ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL13ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL13ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL23ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL23ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", 
   "6"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.769261878163862*^9, 3.769261950169459*^9, {3.769333490156056*^9, 
   3.7693334991277924`*^9}},
 CellLabel->
  "In[808]:=",ExpressionUUID->"c8ebb2eb-1575-4050-b433-6cb5400e8b46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RL12i", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"VEL12ij", "[", "d1", "]"}], "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"VEL11ij", "[", "d1", "]"}], "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"VEL22ij", "[", "d1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RL13i", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"VEL13ij", "[", "d1", "]"}], "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"VEL11ij", "[", "d1", "]"}], "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"VEL33ij", "[", "d1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RL23i", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"VEL23ij", "[", "d1", "]"}], "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"VEL22ij", "[", "d1", "]"}], "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"VEL33ij", "[", "d1", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.7692619433847*^9, {3.7693335031848497`*^9, 3.769333505110936*^9}},
 CellLabel->
  "In[814]:=",ExpressionUUID->"d02feff7-0b5e-4d13-a083-16d634373d85"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"d1", " ", "=", " ", "3"}]}]], "Input",
 CellChangeTimes->{{3.768922937748769*^9, 3.7689229449763327`*^9}},
 CellLabel->
  "In[817]:=",ExpressionUUID->"ed82017a-b8aa-49f2-b96e-d321c0ba6d59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"compute", " ", "the", " ", "mean", " ", "in", " ", "a", " ", 
     RowBox[{"neighbourhood", " ", "--"}]}], ">", " ", 
    RowBox[{"the", " ", "first", " ", "objective"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", 
       RowBox[{"i", "+", "1"}]}], ",", 
      RowBox[{"j", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j", "++"}], ",", " ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"j", "+", "1"}]}], ",", 
        RowBox[{"k", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "3", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "5", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "4", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "6", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "3", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "5", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "4", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "6", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.768922952396783*^9},
 CellLabel->
  "In[818]:=",ExpressionUUID->"048a541d-7f4d-422b-9a7b-eb180544e527"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EEL1ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"EL1ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EEL2ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"EL2ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"EEL21ij", "[", "d1", "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
       RowBox[{"(", 
        RowBox[{"L", "-", "1"}], ")"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "*)"}]}]}], "Input",
 CellLabel->
  "In[819]:=",ExpressionUUID->"997c3a7c-fefc-4d9c-a8ae-74c1d3955870"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"compute", " ", "the", " ", "mean", " ", "in", " ", "a", " ", 
     RowBox[{"neighbourhood", " ", "--"}]}], ">", " ", 
    RowBox[{"the", " ", "first", " ", "objective"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", 
       RowBox[{"i", "+", "1"}]}], ",", 
      RowBox[{"j", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j", "++"}], ",", " ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"j", "+", "1"}]}], ",", 
        RowBox[{"k", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "3", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "4", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "5", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "6", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7692666879355764`*^9, 3.769333539226641*^9},
 CellLabel->
  "In[821]:=",ExpressionUUID->"86854743-e404-4b23-84d3-316fb86e16f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EEL3ij", "[", "d1", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"EL3ij", "[", 
          RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
      RowBox[{"(", 
       RowBox[{"L", "-", "1"}], ")"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{3.76926665988597*^9, 3.7693335431107855`*^9},
 CellLabel->
  "In[822]:=",ExpressionUUID->"46ffbeea-ee7a-4adf-9514-a5c2bc55cffb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.768923001920141*^9},
 CellLabel->
  "In[823]:=",ExpressionUUID->"6555d3c6-c740-4692-a187-724cc49734a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7692620164508123`*^9, 3.769333585652463*^9},
 CellLabel->
  "In[824]:=",ExpressionUUID->"a2d4ced5-461a-49cf-b362-60d2c2fbddbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7692620508523865`*^9, 3.769333608932351*^9},
 CellLabel->
  "In[825]:=",ExpressionUUID->"29abe1c8-5c72-42ff-aaa9-8be1105b37f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7692621012633104`*^9, 3.769333816292301*^9},
 CellLabel->
  "In[826]:=",ExpressionUUID->"114bb40f-c2b7-4b21-a6e7-64c0f0a0e7a8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VEL11ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL11ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL22ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL22ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL33ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL33ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL12ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL12ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL13ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL13ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL23ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL23ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", 
   "6"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.7689230337968936`*^9, 3.769262155048621*^9, {3.769333787689972*^9, 
   3.769333793046421*^9}},
 CellLabel->
  "In[827]:=",ExpressionUUID->"9af26a57-91ba-4a0a-bfd0-53fb8b5ac99a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RL12i", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"VEL12ij", "[", "d1", "]"}], "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"VEL11ij", "[", "d1", "]"}], "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"VEL22ij", "[", "d1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RL13i", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"VEL13ij", "[", "d1", "]"}], "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"VEL11ij", "[", "d1", "]"}], "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"VEL33ij", "[", "d1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RL23i", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"VEL23ij", "[", "d1", "]"}], "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"VEL22ij", "[", "d1", "]"}], "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"VEL33ij", "[", "d1", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.7692643568708735`*^9, {3.7693337811530805`*^9, 3.76933378478337*^9}},
 CellLabel->
  "In[833]:=",ExpressionUUID->"81028876-fec0-4ef1-8b3a-e4733a74b9a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"d1", " ", "=", " ", "4"}]}]], "Input",
 CellChangeTimes->{{3.768923251454961*^9, 3.7689232585665565`*^9}},
 CellLabel->
  "In[836]:=",ExpressionUUID->"1a477484-2271-42a9-a0e1-e46720aee302"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"compute", " ", "the", " ", "mean", " ", "in", " ", "a", " ", 
     RowBox[{"neighbourhood", " ", "--"}]}], ">", " ", 
    RowBox[{"the", " ", "first", " ", "objective"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", 
       RowBox[{"i", "+", "1"}]}], ",", 
      RowBox[{"j", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j", "++"}], ",", " ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"j", "+", "1"}]}], ",", 
        RowBox[{"k", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "3", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "5", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "4", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "6", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "3", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "5", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "4", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "6", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7689232798214073`*^9},
 CellLabel->
  "In[837]:=",ExpressionUUID->"86ac22b6-e3cd-40c4-ac2a-88d1561c1f3a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EEL1ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"EL1ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EEL2ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"EL2ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"EEL21ij", "[", "d1", "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
       RowBox[{"(", 
        RowBox[{"L", "-", "1"}], ")"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "*)"}]}]}], "Input",
 CellLabel->
  "In[838]:=",ExpressionUUID->"471f5590-265d-4d77-a4f0-48e6df70e505"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"compute", " ", "the", " ", "mean", " ", "in", " ", "a", " ", 
     RowBox[{"neighbourhood", " ", "--"}]}], ">", " ", 
    RowBox[{"the", " ", "first", " ", "objective"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", 
       RowBox[{"i", "+", "1"}]}], ",", 
      RowBox[{"j", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j", "++"}], ",", " ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"j", "+", "1"}]}], ",", 
        RowBox[{"k", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "3", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "4", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "5", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "6", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7692667107686977`*^9, 3.769333670217081*^9},
 CellLabel->
  "In[840]:=",ExpressionUUID->"9e579280-13ff-4b7e-b782-b8835ef45c3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EEL3ij", "[", "d1", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"EL3ij", "[", 
          RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
      RowBox[{"(", 
       RowBox[{"L", "-", "1"}], ")"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{3.76926674204573*^9, 3.769333663895097*^9},
 CellLabel->
  "In[841]:=",ExpressionUUID->"25d20175-292a-4e87-bbb4-ab6b941cc736"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[842]:=",ExpressionUUID->"aff83c28-0437-4ec0-935f-0c7027f323e5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.769348436326359*^9},
 CellLabel->
  "In[843]:=",ExpressionUUID->"096b96cd-97a7-455d-b8d6-49b6d701134b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7692644174019966`*^9, 3.769333693708867*^9},
 CellLabel->
  "In[844]:=",ExpressionUUID->"675f2dab-a047-4016-9683-36cf786b00fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7692644609901686`*^9, 3.7693337246920652`*^9},
 CellLabel->
  "In[845]:=",ExpressionUUID->"36adfa9f-bfec-4cd8-9c32-8137861081fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7692645557649145`*^9, 3.7693337394440193`*^9},
 CellLabel->
  "In[846]:=",ExpressionUUID->"0940b7f0-5c41-486f-8f38-735442a786c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VEL11ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL11ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL22ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL22ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL33ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL33ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL12ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL12ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL13ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL13ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL23ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL23ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", 
   "6"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.769262168488192*^9, {3.769333760488968*^9, 3.769333765374632*^9}},
 CellLabel->
  "In[847]:=",ExpressionUUID->"60233768-f694-49c6-95de-73b6d0730446"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RL12i", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"VEL12ij", "[", "d1", "]"}], "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"VEL11ij", "[", "d1", "]"}], "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"VEL22ij", "[", "d1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RL13i", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"VEL13ij", "[", "d1", "]"}], "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"VEL11ij", "[", "d1", "]"}], "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"VEL33ij", "[", "d1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RL23i", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"VEL23ij", "[", "d1", "]"}], "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"VEL22ij", "[", "d1", "]"}], "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"VEL33ij", "[", "d1", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.7692621927525916`*^9, {3.7693337677345085`*^9, 3.7693337697655396`*^9}},
 CellLabel->
  "In[853]:=",ExpressionUUID->"a75b0143-09ef-4007-a5e9-fa77ff514c12"],

Cell[BoxData[
 RowBox[{"d1", " ", "=", " ", "5"}]], "Input",
 CellChangeTimes->{{3.769348311677885*^9, 3.769348315606005*^9}},
 CellLabel->
  "In[856]:=",ExpressionUUID->"d2f6739e-83e8-4bdc-a2d8-20746c8f6b21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"compute", " ", "the", " ", "mean", " ", "in", " ", "a", " ", 
     RowBox[{"neighbourhood", " ", "--"}]}], ">", " ", 
    RowBox[{"the", " ", "first", " ", "objective"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", 
       RowBox[{"i", "+", "1"}]}], ",", 
      RowBox[{"j", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j", "++"}], ",", " ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"j", "+", "1"}]}], ",", 
        RowBox[{"k", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "3", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "5", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "4", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL1ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "6", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM1", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "3", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "5", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "4", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL2ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "6", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM2", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.769348321513198*^9},
 CellLabel->
  "In[857]:=",ExpressionUUID->"f893753e-8e91-404e-83c0-1ea095acd29d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EEL1ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"EL1ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EEL2ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"EL2ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}]}], "Input",
 CellChangeTimes->{{3.769348526438306*^9, 3.769348535853819*^9}},
 CellLabel->
  "In[858]:=",ExpressionUUID->"1c69e659-96a7-4308-84d9-51a45168caaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"compute", " ", "the", " ", "mean", " ", "in", " ", "a", " ", 
     RowBox[{"neighbourhood", " ", "--"}]}], ">", " ", 
    RowBox[{"the", " ", "first", " ", "objective"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", 
       RowBox[{"i", "+", "1"}]}], ",", 
      RowBox[{"j", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j", "++"}], ",", " ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"j", "+", "1"}]}], ",", 
        RowBox[{"k", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "1"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "2"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "3", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "3"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "4", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "4"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "5", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "5"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"k", ",", "i"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EL3ij", "[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "6", ",", "d1"}], "]"}], " ",
           "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "6"}], "]"}], 
               "^", "d1"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"i", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"j", ",", "k"}], "]"}], "*", 
                 RowBox[{"flowM3", "[", 
                  RowBox[{
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                   RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7693485684672413`*^9},
 CellLabel->
  "In[860]:=",ExpressionUUID->"e9f6c0cf-dda9-40fb-9db1-d61ecb428e31"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EEL3ij", "[", "d1", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"EL3ij", "[", 
          RowBox[{"i", ",", "j", ",", "k", ",", "d", ",", "d1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"d", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
      RowBox[{"(", 
       RowBox[{"L", "-", "1"}], ")"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{3.7693486003260183`*^9},
 CellLabel->
  "In[861]:=",ExpressionUUID->"2e55f1bc-e468-46f7-bfd8-9de7855e3ded"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL11ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL22ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda2", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL12ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda1", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7693486348485413`*^9},
 CellLabel->
  "In[862]:=",ExpressionUUID->"6697cbef-4141-4748-a60c-ed0295eaa600"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL23ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM2", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL2ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.769348377070644*^9},
 CellLabel->
  "In[863]:=",ExpressionUUID->"664f5cfb-542c-4af5-b2af-b89a36b398ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL33ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.769348683324404*^9},
 CellLabel->
  "In[864]:=",ExpressionUUID->"075720fe-c15e-43b3-b13f-45e0184b0632"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compute", " ", "the", " ", "variance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i1", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i1", "\[LessEqual]", " ", "L"}], ",", " ", 
    RowBox[{"i1", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j1", "=", "1"}], ",", 
      RowBox[{"j1", "\[LessEqual]", " ", "L"}], ",", " ", 
      RowBox[{"j1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k1", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k1", "\[LessEqual]", " ", "L"}], ",", 
        RowBox[{"k1", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "1"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "1"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "1", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "2"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "2"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "2", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "3"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "3"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "3", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "4"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "4"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "4", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "5"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "5"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "j1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"k1", ",", "i1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "5", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LVL13ij", "[", 
           RowBox[{"i1", ",", "j1", ",", "k1", ",", "d1", ",", "6"}], "]"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"lambda3", "[", 
                RowBox[{"i1", ",", "j1", ",", "k1", ",", "p", ",", "6"}], 
                "]"}], "^", "d1"}], " ", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM3", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL3ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"i1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "1"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"distance", "[", 
                    RowBox[{"j1", ",", "k1"}], "]"}], "*", 
                   RowBox[{"flowM1", "[", 
                    RowBox[{
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "2"}], "]"}], ",", 
                    RowBox[{"pIndex", "[", 
                    RowBox[{"p", ",", "3"}], "]"}]}], "]"}]}]}], ")"}], " ", 
                "-", " ", 
                RowBox[{"EL1ij", "[", 
                 RowBox[{"i1", ",", "j1", ",", "k1", ",", "6", ",", "d1"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{"countI", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
           "countI"}]}]}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7693487322190294`*^9},
 CellLabel->
  "In[865]:=",ExpressionUUID->"ba59dc5d-dd1c-4629-9ac1-87de9ec3c39d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VEL11ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL11ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL22ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL22ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL33ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL33ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL12ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL12ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL13ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL13ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VEL23ij", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"LVL23ij", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "d1", ",", "o"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "+", "1"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", "1", ",", "6"}], "}"}]}], "]"}], "/", "L"}], "/", 
     RowBox[{"(", 
      RowBox[{"L", "-", "1"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"L", "-", "2"}], ")"}]}], "/", 
   "6"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{3.7693483513899117`*^9},
 CellLabel->
  "In[866]:=",ExpressionUUID->"8d7d51f8-b515-479a-8ce4-2787604e2c97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RL12i", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"VEL12ij", "[", "d1", "]"}], "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"VEL11ij", "[", "d1", "]"}], "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"VEL22ij", "[", "d1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RL13i", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"VEL13ij", "[", "d1", "]"}], "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"VEL11ij", "[", "d1", "]"}], "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"VEL33ij", "[", "d1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RL23i", "[", "d1", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"VEL23ij", "[", "d1", "]"}], "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"VEL22ij", "[", "d1", "]"}], "]"}]}], " ", "/", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"VEL33ij", "[", "d1", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.7692621927525916`*^9, {3.7693337677345085`*^9, 3.7693337697655396`*^9}},
 CellLabel->
  "In[872]:=",ExpressionUUID->"5f983807-e774-4bde-81cb-1d50dd490197"]
},
WindowSize->{977, 1011},
WindowMargins->{{Automatic, -1278}, {Automatic, 20}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 697, 13, 67, "Input",ExpressionUUID->"0bd87496-db0f-4ec9-8596-2c2cd79e7339"],
Cell[1258, 35, 1449, 24, 86, "Input",ExpressionUUID->"f34464f0-40d0-471f-8985-a3d280e1cb83"],
Cell[2710, 61, 1472, 34, 143, "Input",ExpressionUUID->"60273512-7864-403c-be58-f9c76b786042"],
Cell[4185, 97, 1399, 33, 105, "Input",ExpressionUUID->"bb35a381-c285-4e0a-82d9-8f36c7801f43"],
Cell[5587, 132, 1059, 25, 67, "Input",ExpressionUUID->"0bca0c09-008e-4e05-a6f1-6a540435af18"],
Cell[6649, 159, 1356, 28, 86, "Input",ExpressionUUID->"8f29069e-1b7c-4f7d-9a44-9ddc6d4aff64"],
Cell[8008, 189, 3046, 66, 181, "Input",ExpressionUUID->"46743b3d-1e13-4156-8fe6-d6d1da96c3ec"],
Cell[11057, 257, 8674, 236, 352, "Input",ExpressionUUID->"9026733f-7e3f-446b-86b8-b5670f2c6b96"],
Cell[19734, 495, 5929, 159, 162, "Input",ExpressionUUID->"0d5a285f-0f3b-44be-aa0c-1e26eb4063dc"],
Cell[25666, 656, 12588, 335, 447, "Input",ExpressionUUID->"9ebe4fdf-80dc-4ba4-9dd2-1f79b4094cce"],
Cell[38257, 993, 991, 20, 86, "Input",ExpressionUUID->"2a33c832-eace-4bb9-be8b-a6354886daaa"],
Cell[39251, 1015, 4045, 114, 162, "Input",ExpressionUUID->"b9a27159-560d-4b17-a8dc-90b80b39f78d"],
Cell[43299, 1131, 3956, 113, 162, "Input",ExpressionUUID->"f4906788-40f6-4f1d-9d12-2d2de6d0df5e"],
Cell[47258, 1246, 3812, 111, 162, "Input",ExpressionUUID->"8c74b5c2-767e-4a6e-8c0a-a782099cf25c"],
Cell[51073, 1359, 8479, 193, 409, "Input",ExpressionUUID->"6b8f5418-fad9-4f76-b03e-0e39dea86b8c"],
Cell[59555, 1554, 990, 16, 67, "Input",ExpressionUUID->"9de3d4b6-8369-44b5-bb7f-35f23cacdbd2"],
Cell[60548, 1572, 8840, 201, 409, "Input",ExpressionUUID->"43df0877-b359-4b45-baea-d883952d63e7"],
Cell[69391, 1775, 8011, 189, 428, "Input",ExpressionUUID->"6ad04df6-17bd-4a39-bf24-74cd42afee66"],
Cell[77405, 1966, 694, 11, 28, "Input",ExpressionUUID->"d26b95fc-6c3b-4ab7-adb0-191c8a43526e"],
Cell[78102, 1979, 20494, 480, 998, "Input",ExpressionUUID->"5ba2a021-78b9-43cc-81b9-e2e2d2b01d36"],
Cell[98599, 2461, 3696, 90, 67, "Input",ExpressionUUID->"a12e4975-35d1-4aad-af40-7609160158bc"],
Cell[102298, 2553, 10470, 250, 542, "Input",ExpressionUUID->"3bc5560b-d600-4f37-9178-434db6e4f4d6"],
Cell[112771, 2805, 1028, 28, 28, "Input",ExpressionUUID->"9a2c17c4-8f57-4f29-9714-f8c38d31ec41"],
Cell[113802, 2835, 55623, 1280, 2138, "Input",ExpressionUUID->"b5ded720-26a0-4e96-aa31-8ebc8ff7fdb6"],
Cell[169428, 4117, 18667, 436, 770, "Input",ExpressionUUID->"84e4cefc-0461-4139-83c6-0385817de101"],
Cell[188098, 4555, 18714, 437, 770, "Input",ExpressionUUID->"8ae8a940-dcf0-40e0-89b0-c295764b7552"],
Cell[206815, 4994, 18548, 434, 770, "Input",ExpressionUUID->"53bb2e78-3aa3-414b-9ed6-982a01f16057"],
Cell[225366, 5430, 5803, 157, 124, "Input",ExpressionUUID->"3478ed55-5c15-47bd-83f9-eb2cfe28829a"],
Cell[231172, 5589, 1324, 33, 86, "Input",ExpressionUUID->"8cfe522d-b29a-4d78-90bc-510355b4964e"],
Cell[232499, 5624, 311, 7, 67, "Input",ExpressionUUID->"7b8e40ea-d60f-4c63-ab1c-87e2d91c5831"],
Cell[232813, 5633, 18956, 460, 998, "Input",ExpressionUUID->"749a9d1f-622d-41dc-8dc6-9c4484699011"],
Cell[251772, 6095, 2687, 77, 67, "Input",ExpressionUUID->"7e771288-603e-473a-b818-bd5a1751e96a"],
Cell[254462, 6174, 10015, 244, 542, "Input",ExpressionUUID->"77ed36e2-63d2-491b-878a-30851d5b3f80"],
Cell[264480, 6420, 1035, 29, 48, "Input",ExpressionUUID->"77c5ea62-da9c-46bf-ad69-411817958612"],
Cell[265518, 6451, 53202, 1246, 2138, "Input",ExpressionUUID->"34f81a25-2c83-430e-a4a0-0f013e3e7e85"],
Cell[318723, 7699, 18320, 431, 770, "Input",ExpressionUUID->"772a03d1-64a4-4330-a478-4f9e37b80f89"],
Cell[337046, 8132, 18322, 431, 770, "Input",ExpressionUUID->"4a570776-015c-4638-adc2-1fc201b1a33b"],
Cell[355371, 8565, 18319, 431, 770, "Input",ExpressionUUID->"82a948c6-5659-4bb9-b3df-63dff8687b06"],
Cell[373693, 8998, 5198, 150, 143, "Input",ExpressionUUID->"c8ebb2eb-1575-4050-b433-6cb5400e8b46"],
Cell[378894, 9150, 1199, 32, 86, "Input",ExpressionUUID->"d02feff7-0b5e-4d13-a083-16d634373d85"],
Cell[380096, 9184, 272, 6, 48, "Input",ExpressionUUID->"ed82017a-b8aa-49f2-b96e-d321c0ba6d59"],
Cell[380371, 9192, 18954, 460, 998, "Input",ExpressionUUID->"048a541d-7f4d-422b-9a7b-eb180544e527"],
Cell[399328, 9654, 2645, 76, 67, "Input",ExpressionUUID->"997c3a7c-fefc-4d9c-a8ae-74c1d3955870"],
Cell[401976, 9732, 10013, 244, 542, "Input",ExpressionUUID->"86854743-e404-4b23-84d3-316fb86e16f1"],
Cell[411992, 9978, 1034, 29, 48, "Input",ExpressionUUID->"46ffbeea-ee7a-4adf-9514-a5c2bc55cffb"],
Cell[413029, 10009, 53244, 1247, 2138, "Input",ExpressionUUID->"6555d3c6-c740-4692-a187-724cc49734a1"],
Cell[466276, 11258, 18320, 431, 770, "Input",ExpressionUUID->"a2d4ced5-461a-49cf-b362-60d2c2fbddbc"],
Cell[484599, 11691, 18320, 431, 770, "Input",ExpressionUUID->"29abe1c8-5c72-42ff-aaa9-8be1105b37f7"],
Cell[502922, 12124, 18320, 431, 770, "Input",ExpressionUUID->"114bb40f-c2b7-4b21-a6e7-64c0f0a0e7a8"],
Cell[521245, 12557, 5198, 150, 143, "Input",ExpressionUUID->"9af26a57-91ba-4a0a-bfd0-53fb8b5ac99a"],
Cell[526446, 12709, 1202, 32, 86, "Input",ExpressionUUID->"81028876-fec0-4ef1-8b3a-e4733a74b9a7"],
Cell[527651, 12743, 272, 6, 48, "Input",ExpressionUUID->"1a477484-2271-42a9-a0e1-e46720aee302"],
Cell[527926, 12751, 18956, 460, 998, "Input",ExpressionUUID->"86ac22b6-e3cd-40c4-ac2a-88d1561c1f3a"],
Cell[546885, 13213, 2645, 76, 67, "Input",ExpressionUUID->"471f5590-265d-4d77-a4f0-48e6df70e505"],
Cell[549533, 13291, 10013, 244, 542, "Input",ExpressionUUID->"9e579280-13ff-4b7e-b782-b8835ef45c3c"],
Cell[559549, 13537, 1032, 29, 48, "Input",ExpressionUUID->"25d20175-292a-4e87-bbb4-ab6b941cc736"],
Cell[560584, 13568, 53202, 1246, 2138, "Input",ExpressionUUID->"aff83c28-0437-4ec0-935f-0c7027f323e5"],
Cell[613789, 14816, 151, 3, 28, "Input",ExpressionUUID->"096b96cd-97a7-455d-b8d6-49b6d701134b"],
Cell[613943, 14821, 18320, 431, 770, "Input",ExpressionUUID->"675f2dab-a047-4016-9683-36cf786b00fc"],
Cell[632266, 15254, 18322, 431, 770, "Input",ExpressionUUID->"36adfa9f-bfec-4cd8-9c32-8137861081fc"],
Cell[650591, 15687, 18322, 431, 770, "Input",ExpressionUUID->"0940b7f0-5c41-486f-8f38-735442a786c1"],
Cell[668916, 16120, 5170, 149, 143, "Input",ExpressionUUID->"60233768-f694-49c6-95de-73b6d0730446"],
Cell[674089, 16271, 1205, 32, 86, "Input",ExpressionUUID->"a75b0143-09ef-4007-a5e9-fa77ff514c12"],
Cell[675297, 16305, 209, 4, 28, "Input",ExpressionUUID->"d2f6739e-83e8-4bdc-a2d8-20746c8f6b21"],
Cell[675509, 16311, 18954, 460, 998, "Input",ExpressionUUID->"f893753e-8e91-404e-83c0-1ea095acd29d"],
Cell[694466, 16773, 1800, 51, 48, "Input",ExpressionUUID->"1c69e659-96a7-4308-84d9-51a45168caaa"],
Cell[696269, 16826, 9991, 244, 542, "Input",ExpressionUUID->"e9f6c0cf-dda9-40fb-9db1-d61ecb428e31"],
Cell[706263, 17072, 1013, 29, 48, "Input",ExpressionUUID->"2e55f1bc-e468-46f7-bfd8-9de7855e3ded"],
Cell[707279, 17103, 53246, 1247, 2138, "Input",ExpressionUUID->"6697cbef-4141-4748-a60c-ed0295eaa600"],
Cell[760528, 18352, 18296, 431, 770, "Input",ExpressionUUID->"664f5cfb-542c-4af5-b2af-b89a36b398ce"],
Cell[778827, 18785, 18296, 431, 770, "Input",ExpressionUUID->"075720fe-c15e-43b3-b13f-45e0184b0632"],
Cell[797126, 19218, 18298, 431, 770, "Input",ExpressionUUID->"ba59dc5d-dd1c-4629-9ac1-87de9ec3c39d"],
Cell[815427, 19651, 5123, 148, 143, "Input",ExpressionUUID->"8d7d51f8-b515-479a-8ce4-2787604e2c97"],
Cell[820553, 19801, 1205, 32, 86, "Input",ExpressionUUID->"5f983807-e774-4bde-81cb-1d50dd490197"]
}
]
*)

